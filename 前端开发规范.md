# 智能设计助手前端开发规范

## 项目概述

本项目是一个基于Vue 3 + Element Plus的智能设计助手前端应用，采用现代化的前端技术栈，提供用户管理、模板管理、需求管理、ER模型生成等功能。

## 技术栈

- **框架**: Vue 3.5.18 (Composition API)
- **构建工具**: Vite 7.1.2
- **UI组件库**: Element Plus 2.6.0
- **状态管理**: Pinia 2.1.0
- **路由管理**: Vue Router 4.3.0
- **HTTP客户端**: Axios 1.6.0
- **样式预处理器**: Sass 1.71.0
- **图标库**: @element-plus/icons-vue 2.3.0

## 项目结构

```
src/
├── api/                    # API接口定义
│   ├── data-standards.js   # 数据标准相关API
│   ├── er-model.js         # ER模型相关API
│   ├── requirement.js      # 需求相关API
│   ├── template.js         # 模板相关API
│   └── user.js            # 用户相关API
├── assets/                 # 静态资源
│   └── vue.svg
├── components/             # 公共组件
│   ├── ai/                # AI相关组件
│   ├── er/                # ER模型相关组件
│   ├── requirement/       # 需求相关组件
│   ├── settings/          # 设置相关组件
│   └── template/          # 模板相关组件
├── config/                # 配置文件
│   └── index.js           # 环境配置
├── layout/                # 布局组件
│   └── Layout.vue         # 主布局
├── router/                # 路由配置
│   └── index.js           # 路由定义
├── stores/                # 状态管理
│   └── user.js            # 用户状态
├── utils/                 # 工具函数
│   └── request.js         # HTTP请求封装
├── views/                 # 页面组件
│   ├── Login.vue          # 登录页
│   ├── Register.vue       # 注册页
│   └── ...                # 其他页面
├── App.vue                # 根组件
├── main.js                # 应用入口
└── style.css              # 全局样式
```

## 开发规范

### 1. 代码风格规范

#### 1.1 文件命名规范

- **组件文件**: 使用PascalCase命名，如 `UserManagement.vue`
- **工具文件**: 使用camelCase命名，如 `request.js`
- **配置文件**: 使用kebab-case命名，如 `vite.config.js`
- **样式文件**: 使用kebab-case命名，如 `style.css`

#### 1.2 变量命名规范

```javascript
// ✅ 正确
const userName = 'admin'
const userInfo = {}
const isLoggedIn = true
const API_BASE_URL = 'http://localhost:8080'

// ❌ 错误
const username = 'admin'  // 应该使用camelCase
const user_info = {}      // 应该使用camelCase
const isloggedin = true   // 应该使用camelCase
```

#### 1.3 组件命名规范

```javascript
// ✅ 正确
export default {
  name: 'UserManagement'
}

// 或者使用setup语法糖时，文件名即为组件名
// UserManagement.vue
```

#### 1.4 常量命名规范

```javascript
// ✅ 正确
const API_ENDPOINTS = {
  LOGIN: '/api/login',
  USER_INFO: '/api/user/info'
}

const USER_ROLES = {
  ADMIN: 'admin',
  USER: 'user'
}
```

### 2. Vue组件开发规范

#### 2.1 组件结构

```vue
<template>
  <!-- 模板内容 -->
</template>

<script setup>
// 导入语句
import { ref, reactive, onMounted } from 'vue'
import { ElMessage } from 'element-plus'

// 组件属性定义
const props = defineProps({
  title: {
    type: String,
    required: true
  }
})

// 事件定义
const emit = defineEmits(['update', 'delete'])

// 响应式数据
const loading = ref(false)
const formData = reactive({
  name: '',
  email: ''
})

// 计算属性
const isValid = computed(() => {
  return formData.name && formData.email
})

// 方法定义
const handleSubmit = async () => {
  // 方法实现
}

// 生命周期
onMounted(() => {
  // 初始化逻辑
})
</script>

<style scoped lang="scss">
// 样式定义
</style>
```

#### 2.2 组件导入规范

```javascript
// ✅ 正确 - 按类型分组导入
// Vue相关
import { ref, reactive, computed, onMounted } from 'vue'
import { useRouter } from 'vue-router'

// 第三方库
import { ElMessage, ElMessageBox } from 'element-plus'
import axios from 'axios'

// 本地模块
import { useUserStore } from '@/stores/user'
import { login } from '@/api/user'
import config from '@/config'
```

#### 2.3 Props定义规范

```javascript
// ✅ 正确
const props = defineProps({
  // 基础类型
  title: {
    type: String,
    required: true,
    default: ''
  },
  count: {
    type: Number,
    default: 0
  },
  isVisible: {
    type: Boolean,
    default: false
  },
  // 对象类型
  userInfo: {
    type: Object,
    default: () => ({})
  },
  // 数组类型
  options: {
    type: Array,
    default: () => []
  }
})
```

#### 2.4 事件定义规范

```javascript
// ✅ 正确
const emit = defineEmits([
  'update',
  'delete',
  'submit',
  'cancel'
])

// 使用事件
const handleDelete = (item) => {
  emit('delete', item)
}
```

### 3. 状态管理规范

#### 3.1 Pinia Store定义

```javascript
// stores/user.js
import { defineStore } from 'pinia'
import { ref, computed } from 'vue'

export const useUserStore = defineStore('user', () => {
  // 状态定义
  const token = ref('')
  const userInfo = ref({})
  const permissions = ref([])

  // 计算属性
  const isLoggedIn = computed(() => !!token.value)
  const hasPermission = computed(() => (permission) => {
    return permissions.value.includes(permission)
  })

  // 方法定义
  const login = async (credentials) => {
    // 登录逻辑
  }

  const logout = () => {
    // 登出逻辑
  }

  return {
    // 状态
    token,
    userInfo,
    permissions,
    // 计算属性
    isLoggedIn,
    hasPermission,
    // 方法
    login,
    logout
  }
})
```

#### 3.2 Store使用规范

```javascript
// ✅ 正确
import { useUserStore } from '@/stores/user'

const userStore = useUserStore()

// 读取状态
console.log(userStore.userInfo)

// 修改状态
userStore.token = 'new-token'

// 调用方法
await userStore.login(credentials)
```

### 4. API接口规范

#### 4.1 API文件组织

```javascript
// api/user.js
import request from '@/utils/request'

// 用户登录
export const login = (data) => {
  return request({
    url: '/api/login',
    method: 'post',
    data
  })
}

// 获取用户信息
export const getUserInfo = () => {
  return request({
    url: '/api/user/info',
    method: 'get'
  })
}

// 更新用户信息
export const updateUserInfo = (data) => {
  return request({
    url: '/api/user/info',
    method: 'put',
    data
  })
}
```

#### 4.2 请求响应处理

```javascript
// ✅ 正确
const handleSubmit = async () => {
  try {
    loading.value = true
    const response = await login(formData)
    ElMessage.success('登录成功')
    // 处理成功响应
  } catch (error) {
    console.error('登录失败:', error)
    ElMessage.error('登录失败，请重试')
  } finally {
    loading.value = false
  }
}
```

### 5. 路由配置规范

#### 5.1 路由定义

```javascript
// router/index.js
const routes = [
  {
    path: '/login',
    name: 'Login',
    component: () => import('@/views/Login.vue'),
    meta: { 
      requiresAuth: false,
      title: '登录'
    }
  },
  {
    path: '/user-management',
    name: 'UserManagement',
    component: () => import('@/views/UserManagement.vue'),
    meta: { 
      title: '用户管理',
      icon: 'User',
      roles: ['admin']
    }
  }
]
```

#### 5.2 路由守卫

```javascript
// ✅ 正确
router.beforeEach((to, from, next) => {
  const token = localStorage.getItem('token')
  const userRole = localStorage.getItem('userRole')

  // 不需要认证的页面
  if (to.meta.requiresAuth === false) {
    next()
    return
  }

  // 检查登录状态
  if (!token) {
    next('/login')
    return
  }

  // 检查权限
  if (to.meta.roles && !to.meta.roles.includes(userRole)) {
    // 根据用户角色跳转到不同的默认页面
    if (userRole === 'admin') {
      next('/user-management')
    } else {
      next('/requirement-management/input')
    }
    return
  }

  next()
})
```

### 6. 样式开发规范

#### 6.1 CSS类命名规范

```scss
// ✅ 正确 - 使用BEM命名法
.user-management {
  &__header {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  &__table {
    margin-top: 20px;
  }

  &__pagination {
    margin-top: 20px;
    display: flex;
    justify-content: flex-end;
  }

  &--loading {
    opacity: 0.6;
  }
}

// 或者使用kebab-case
.user-management {
  .search-card {
    margin-bottom: 20px;
  }

  .table-card {
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
  }
}
```

#### 6.2 样式作用域

```vue
<style scoped lang="scss">
// ✅ 正确 - 使用scoped避免样式污染
.component-name {
  // 样式定义
}
</style>
```

### 7. 错误处理规范

#### 7.1 全局错误处理

```javascript
// main.js
app.config.errorHandler = (err, vm, info) => {
  console.error('Vue错误:', err)
  console.error('错误信息:', info)
  // 可以在这里添加错误上报逻辑
}
```

#### 7.2 API错误处理

```javascript
// ✅ 正确
const handleApiCall = async () => {
  try {
    const response = await apiCall()
    ElMessage.success('操作成功')
  } catch (error) {
    console.error('API调用失败:', error)
    
    // 根据错误类型显示不同消息
    if (error.response?.status === 401) {
      ElMessage.error('登录已过期，请重新登录')
      // 跳转到登录页
    } else if (error.response?.status === 403) {
      ElMessage.error('没有权限执行此操作')
    } else {
      ElMessage.error('操作失败，请重试')
    }
  }
}
```

### 8. 性能优化规范

#### 8.1 组件懒加载

```javascript
// ✅ 正确
const UserManagement = () => import('@/views/UserManagement.vue')
```

#### 8.2 图片优化

```vue
<!-- ✅ 正确 -->
<img src="@/assets/logo.png" alt="Logo" loading="lazy" />
```

#### 8.3 列表渲染优化

```vue
<!-- ✅ 正确 -->
<template v-for="item in list" :key="item.id">
  <div>{{ item.name }}</div>
</template>
```

### 9. 测试规范

#### 9.1 单元测试

```javascript
// 建议为关键业务逻辑编写单元测试
import { mount } from '@vue/test-utils'
import UserManagement from '@/views/UserManagement.vue'

describe('UserManagement', () => {
  it('should render correctly', () => {
    const wrapper = mount(UserManagement)
    expect(wrapper.exists()).toBe(true)
  })
})
```

### 10. 代码注释规范

#### 10.1 函数注释

```javascript
/**
 * 用户登录
 * @param {Object} credentials - 登录凭据
 * @param {string} credentials.username - 用户名
 * @param {string} credentials.password - 密码
 * @returns {Promise<Object>} 登录结果
 */
const login = async (credentials) => {
  // 实现逻辑
}
```

#### 10.2 组件注释

```vue
<!--
  用户管理组件
  功能：用户列表展示、增删改查操作
  作者：张三
  创建时间：2024-01-01
-->
<template>
  <!-- 组件内容 -->
</template>
```

### 11. Git提交规范

#### 11.1 提交信息格式

```
<type>(<scope>): <subject>

<body>

<footer>
```

#### 11.2 提交类型

- `feat`: 新功能
- `fix`: 修复bug
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `test`: 测试相关
- `chore`: 构建过程或辅助工具的变动

#### 11.3 提交示例

```
feat(user): 添加用户管理功能

- 新增用户列表页面
- 实现用户增删改查操作
- 添加用户权限控制

Closes #123
```

### 12. 环境配置规范

#### 12.1 环境变量

```javascript
// config/index.js
const config = {
  development: {
    apiBaseUrl: 'http://localhost:8080',
    appTitle: '智能设计助手'
  },
  production: {
    apiBaseUrl: 'https://api.example.com',
    appTitle: '智能设计助手'
  }
}
```

#### 12.2 开发环境配置

```javascript
// vite.config.js
export default defineConfig({
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:8080',
        changeOrigin: true
      }
    }
  }
})
```

### 13. 安全规范

#### 13.1 输入验证

```javascript
// ✅ 正确
const validateInput = (input) => {
  if (!input || typeof input !== 'string') {
    throw new Error('输入参数无效')
  }
  
  // 防止XSS攻击
  return input.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
}
```

#### 13.2 敏感信息处理

```javascript
// ✅ 正确 - 不在代码中硬编码敏感信息
const API_KEY = import.meta.env.VITE_API_KEY
```

### 14. 文档规范

#### 14.1 README文档

每个组件都应该有清晰的文档说明，包括：
- 组件功能描述
- Props说明
- Events说明
- 使用示例

#### 14.2 代码文档

关键业务逻辑应该有详细的注释说明，包括：
- 功能说明
- 参数说明
- 返回值说明
- 使用示例

## 开发工具推荐

### 1. 代码编辑器
- **VS Code** + 以下插件：
  - Vetur 或 Volar (Vue支持)
  - ESLint
  - Prettier
  - Auto Rename Tag
  - Bracket Pair Colorizer

### 2. 浏览器开发工具
- Vue DevTools
- Element Plus DevTools

### 3. 代码质量工具
- ESLint
- Prettier
- Husky (Git hooks)

## 常见问题与解决方案

### 1. 组件通信
- 父子组件：使用props和emit
- 跨级组件：使用provide/inject
- 全局状态：使用Pinia

### 2. 路由权限控制
- 使用路由守卫检查用户权限
- 在meta中定义角色要求
- 动态路由根据用户权限生成

### 3. API请求优化
- 使用axios拦截器统一处理请求响应
- 实现请求重试机制
- 添加请求loading状态

## 总结

遵循以上开发规范可以确保：
1. 代码风格统一，提高可读性
2. 组件复用性高，维护成本低
3. 项目结构清晰，便于团队协作
4. 性能优化，用户体验良好
5. 安全性高，避免常见漏洞

请所有开发人员严格遵守本规范，如有疑问请及时与项目负责人沟通。
